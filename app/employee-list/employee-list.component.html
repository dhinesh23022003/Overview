<div class="container">
  <div class="text-center mb-3 mt-2">
    <h2>Employee List</h2>
  </div>
  <button class="btn btn-outline-success btn-rectangle mb-3" (click)="openAddModal(addModal)">
    Add Employee
  </button>
  <button class="btn btn-outline-primary btn-rectangle mb-3 ml-2" (click)="UploadFIleFormat()">
    Import
  </button>
  <button class="btn btn-outline-dark btn-rectangle ml-3 mb-3">
    <label for="updateExcel">
      Update Via Excel
    </label>
    <input type="file" id="updateExcel" (change)="updateThrougExcel($event)" style="display: none;">
  </button>
  <button class="btn btn-outline-info btn-rectangle mb-3 ml-2" (click)="exportdata()">
    Download Excel
  </button>
  <button class="btn btn-outline-warning btn-rectangle ml-3 mb-3">
    <label for="fileInput">
      Bulk Upload
    </label>
    <input type="file" id="fileInput" (change)="readExcel($event)" style="display: none;">
  </button>
  <table id="employeetablexl" class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th>Employee ID</th>
        <th>Image</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Mobile Number</th>
        <th>Date Of Birth</th>
        <th>Gender</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of employees">
        <ng-template #imageModal>
          <div class="modal-header">
            <h4 class="modal-title">Employee Profile</h4>
            <button type="button" class="close" (click)="modalRef.close()">
              &times;
            </button>
          </div>
          <div class="modal-body d-flex flex-column align-items-center justify-content-center">
            <div class="mb-3">
              <img src="{{emp.imageurl}}" alt="Image not working" class="img-fluid">
            </div>
            <div>
              <button class="btn btn-outline-secondary ml-2" (click)="modalRef.close()">
                Close
              </button>
            </div>
          </div>
        </ng-template>
        

        <td>{{ emp.id }}</td>
        <td>
          <button (click)="openImageModal(imageModal)">
            <i class="bi bi-eye"></i>
          </button>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.fName }}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="text" [(ngModel)]="emp.fName">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.lName }}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="text" [(ngModel)]="emp.lName">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.email }}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="text" [(ngModel)]="emp.email">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.mobileNo}}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="text" [(ngModel)]="emp.mobileNo">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.dob}}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="date" [(ngModel)]="emp.dob">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            {{ emp.gender}}
          </div>
          <div *ngIf="emp.isEdit">
            <input type="text" [(ngModel)]="emp.gender">
          </div>
        </td>
        <td>
          <div *ngIf="!emp.isEdit">
            <button class="btn btn-outline-info btn-rectangle ml-2" (click)="onEdit(emp)">
              Edit
            </button>
            <button class="btn btn-outline-warning btn-rectangle ml-2" (click)="openUpdateModal(updateModal, emp)">
              Update
            </button>
            <button class="btn btn-outline-danger btn-rectangle ml-2" (click)="deleteEmployee(deleteModal, emp)">
              Delete
            </button>
          </div>
          <div *ngIf="emp.isEdit">
            <button class="btn btn-outline-info btn-rectangle ml-2" (click)="onEditSave(emp)">
              Save
            </button>
            <button class="btn btn-outline-warning btn-rectangle ml-2" (click)="onEditCancel(emp)">
              Cancel
            </button>
          </div>
        </td>

      </tr>
    </tbody>
  </table>

  <!-- Add Employee Modal -->
  <ng-template #addModal>
    <div class="modal-header">
      <h4 class="modal-title">Add Employee</h4>
      <button type="button" class="close" (click)="modalRef.close()">
        &times;
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="fName">First Name:</label>
          <input type="text" id="fName" formControlName="fName" class="form-control" />
          <div *ngIf="employeeForm.controls['fName'].invalid && employeeForm.controls['fName'].touched"
            class="text-danger">
            First Name is required.
          </div>
        </div>
        <div class="form-group">
          <label for="lName">Last Name:</label>
          <input type="text" id="lName" formControlName="lName" class="form-control" />
          <div *ngIf="employeeForm.controls['lName'].invalid && employeeForm.controls['lName'].touched"
            class="text-danger">
            Last Name is required.
          </div>
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" formControlName="email" class="form-control" />
          <div *ngIf="employeeForm.controls['email'].invalid && employeeForm.controls['email'].touched"
            class="text-danger">
            A valid email is required.
          </div>
        </div>
        <div class="form-group">
          <label for="mobileNo">Mobile Number:</label>
          <input type="text" id="mobileNo" formControlName="mobileNo" class="form-control" />
          <div *ngIf="employeeForm.controls['mobileNo'].invalid && employeeForm.controls['mobileNo'].touched"
            class="text-danger">
            A valid Mobile Number is required.
          </div>
        </div>
        <div class="form-group">
          <label for="dob">Date of Birth:</label>
          <input type="date" id="dob" formControlName="dob" class="form-control" />
          <div *ngIf="employeeForm.controls['dob'].invalid && employeeForm.controls['dob'].touched"
            class="text-danger">
            A valid Date of Birth is required.
          </div>
        </div>
        <div class="form-group">
          <label>Gender :</label>
          <select formControlName="gender" class="form-control" name="Select Gender">
            <option value="" disabled selected>--select option--</option>
            <option *ngFor="let d of Datass" [value]="d.gender">{{ d.gender }}</option>
          </select>
        </div>
              

        <div class="form-group">
          <label for="photo">Upload Photo:</label><br>
          <input type="file" (change)="uploadImage($event)" id="imageurl" formControlName="imageurl"
            class="form-control" />
        </div>


        <div>
          <button type="submit" class="btn btn-outline-success" [disabled]="employeeForm.invalid">
            Save
          </button>
          <button class="btn btn-outline-secondary ml-2" (click)="modalRef.close()">
            Close
          </button>
        </div>
      </form>
    </div>
  </ng-template>

  <!-- Update Employee Modal -->
  <ng-template #updateModal>
    <div class="modal-header">
      <h4 class="modal-title">Update Employee</h4>
      <button type="button" class="close" (click)="modalRef.close()">
        &times;
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="updateEmployeeForm" (ngSubmit)="onUpdateSubmit()">
        <div class="form-group">
          <label for="fName">First Name:</label>
          <input type="text" id="fName" formControlName="fName" class="form-control" />
          <div *ngIf="updateEmployeeForm.controls['fName'].invalid && updateEmployeeForm.controls['fName'].touched"
            class="text-danger">
            First Name is required.
          </div>
        </div>
        <div class="form-group">
          <label for="lName">Last Name:</label>
          <input type="text" id="lName" formControlName="lName" class="form-control" />
          <div *ngIf="updateEmployeeForm.controls['lName'].invalid && updateEmployeeForm.controls['lName'].touched"
            class="text-danger">
            Last Name is required.
          </div>
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" formControlName="email" class="form-control" />
          <div *ngIf="updateEmployeeForm.controls['email'].invalid && updateEmployeeForm.controls['email'].touched"
            class="text-danger">
            A valid email is required.
          </div>
        </div>
        <div class="form-group">
          <label for="mobileNo">Mobile Number:</label>
          <input type="text" id="mobileNo" formControlName="mobileNo" class="form-control" />
          <div *ngIf="updateEmployeeForm.controls['mobileNo'].invalid && updateEmployeeForm.controls['mobileNo'].touched"
            class="text-danger">
            A valid Mobile Number is required.
          </div>
        </div>
        <div class="form-group">
          <label for="dob">Date of Birth:</label>
          <input type="date" id="dob" formControlName="dob" class="form-control" />
          <div *ngIf="updateEmployeeForm.controls['dob'].invalid && updateEmployeeForm.controls['dob'].touched"
            class="text-danger">
            A valid Date of Birth is required.
          </div>
        </div>
        <div class="form-group">
          <label>Gender :</label>
          <select formControlName="gender" class="form-control" name="Select Gender">
            <option value="" disabled selected>--select option--</option>
            <option *ngFor="let d of Datass" [value]="d.gender">{{ d.gender }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="photo">Upload Photo:</label><br>
          <input type="file" (change)="updateUploadImage($event)" id="imageurl" formControlName="imageurl"
            class="form-control" />
        </div>
        <button type="submit" class="btn btn-outline-success " [disabled]="updateEmployeeForm.invalid">
          Update
        </button>
        <button type="button" class="btn btn-outline-secondary ml-3" (click)="modalRef.close()">
          Close
        </button>
      </form>
    </div>
  </ng-template>

  <ng-template #deleteModal>
    <div class="modal-header">
      <h4 class="modal-title">Delete Employee</h4>
      <button type="button" class="close" (click)="modalRef.close()">
        &times;
      </button>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete {{ deleteemployee.fName }}?</p>
      <button class="btn btn-outline-danger" (click)="onDeleteSubmit()">
        Delete
      </button>
      <button class="btn btn-outline-secondary ml-2" (click)="modalRef.close()">
        Close
      </button>
    </div>
  </ng-template>
</div>





